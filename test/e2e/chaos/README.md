# AegisNet 混沌工程测试

## 概述

本目录包含AegisNet的混沌工程测试，通过注入各种故障和异常情况，验证系统的容错能力和恢复机制。这些测试旨在确保AegisNet在生产环境中面对各种意外情况时能够保持稳定运行。

## 测试场景

### 网络故障

- **网络分区**: 模拟集群内部或跨集群的网络分区
- **网络延迟**: 注入高延迟，测试系统对延迟的容忍度
- **网络丢包**: 模拟不同程度的网络丢包率
- **带宽限制**: 限制网络带宽，测试系统在低带宽环境下的表现

### 节点故障

- **节点崩溃**: 随机终止节点，测试系统的自动恢复能力
- **节点重启**: 模拟节点重启场景
- **资源耗尽**: CPU/内存压力测试，模拟资源耗尽情况

### 控制平面故障

- **控制器故障**: 模拟AegisNet控制器组件故障
- **API服务中断**: 模拟Kubernetes API服务暂时不可用
- **etcd故障**: 模拟etcd数据存储故障

## 测试工具

- **Chaos Mesh**: 用于Kubernetes环境的混沌工程平台
- **Toxiproxy**: 网络故障模拟工具
- **Pumba**: 容器故障注入工具

## 目录结构

- `network/`: 网络故障测试场景
- `node/`: 节点故障测试场景
- `controller/`: 控制平面故障测试场景
- `common/`: 共享测试工具和库
- `reports/`: 测试报告输出目录

## 运行测试

```bash
# 安装混沌测试依赖
./install_chaos_tools.sh

# 运行所有混沌测试
./run_all_chaos_tests.sh

# 运行特定测试场景
./run_chaos_test.sh network/partition_test.yaml
```

## 测试指标

- **恢复时间**: 系统从故障中恢复所需的时间
- **数据一致性**: 故障期间和恢复后的数据一致性验证
- **服务可用性**: 故障期间的服务可用性百分比
- **策略执行**: 验证网络策略在故障期间和恢复后的正确执行

## 测试报告

每次测试完成后，系统会生成详细的测试报告，包括：

- 故障注入详情
- 系统响应时间线
- 关键指标数据
- 恢复过程分析
- 发现的问题和建议